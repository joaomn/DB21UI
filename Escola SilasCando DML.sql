-- inserts


INSERT INTO EscoladeMusicaSilasCando.Orquestra (Nome, Cidade, Pais, Dt_criacao)
VALUES
('Orquestra Sinfônica de São Paulo', 'São Paulo', 'Brasil', '1954-06-25'),
('Orquestra Sinfônica Brasileira', 'Rio de Janeiro', 'Brasil', '1940-07-11'),
('Orquestra Filarmônica de Berlim', 'Berlim', 'Alemanha', '1882-10-01'),
('Orquestra Filarmônica de Viena', 'Viena', 'Áustria', '1842-03-28'),
('Orquestra Sinfônica de Chicago', 'Chicago', 'Estados Unidos', '1891-10-15'),
('Orquestra Sinfônica de Londres', 'Londres', 'Reino Unido', '1904-06-09'),
('Orquestra Sinfônica de Boston', 'Boston', 'Estados Unidos', '1881-10-24'),
('Orquestra Sinfônica de Montreal', 'Montreal', 'Canadá', '1934-05-31'),
('Orquestra Sinfônica de Tóquio', 'Tóquio', 'Japão', '1946-10-05'),
('Orquestra Sinfônica de Paris', 'Paris', 'França', '1967-12-16'),
('Orquestra Sinfônica de Israel', 'Tel Aviv', 'Israel', '1936-12-26'),
('Orquestra Sinfônica de Varsóvia', 'Varsóvia', 'Polônia', '1901-11-05'),
('Orquestra Sinfônica de Cleveland', 'Cleveland', 'Estados Unidos', '1918-12-11'),
('Orquestra Sinfônica de Moscou', 'Moscou', 'Rússia', '1951-05-05'),
('Orquestra Sinfônica de Boston Pops', 'Boston', 'Estados Unidos', '1885-02-05'),
('Orquestra Sinfônica de San Francisco', 'San Francisco', 'Estados Unidos', '1911-12-02'),
('Orquestra Sinfônica de Sydney', 'Sydney', 'Austrália', '1932-04-14'),
('Orquestra Sinfônica Nacional da Rádio Francesa', 'Paris', 'França', '1934-11-29'),
('Orquestra Sinfônica de Minnesota', 'Minneapolis', 'Estados Unidos', '1903-04-10'),
('Orquestra Sinfônica de Rotterdam', 'Roterdã', 'Países Baixos', '1918-06-15');



INSERT INTO EscoladeMusicaSilasCando.Orquestra (Nome, Cidade, Pais, Dt_criacao)
VALUES
('Orquestra Sinfônica de olinda', 'Olinda', 'Brasil', '1954-06-25'),
('Orquestra Popular da Bomba do Hemeterio', 'Recife', 'Brasil', '2002-06-25');



INSERT INTO EscoladeMusicaSilasCando.Musico (Identidade, Dt_nascimento, Nome, Nacionalidade)
VALUES
('123.456.789-00', '1990-01-01', 'João Silva', 'Brasileira'),
('234.567.890-11', '1985-02-14', 'Maria Santos', 'Brasileira'),
('345.678.901-22', '1995-03-28', 'Pedro Rocha', 'Brasileira'),
('456.789.012-33', '1980-04-09', 'Ana Paula Costa', 'Brasileira'),
('567.890.123-44', '1991-05-22', 'Lucas Oliveira', 'Brasileira'),
('678.901.234-55', '1992-06-02', 'Fernanda Santos', 'Brasileira'),
('789.012.345-66', '1988-07-16', 'Gabriel Silva', 'Brasileira'),
('890.123.456-77', '1994-08-27', 'Larissa Castro', 'Brasileira'),
('901.234.567-88', '1987-09-11', 'Paulo Roberto', 'Brasileira'),
('012.345.678-99', '1993-10-30', 'Roberta Almeida', 'Brasileira'),
('123.456.789-00', '1989-11-03', 'Thiago Andrade', 'Brasileira'),
('234.567.890-11', '1986-12-25', 'Luciana Santos', 'Brasileira'),
('345.678.901-22', '1992-01-07', 'Guilherme Oliveira', 'Brasileira'),
('456.789.012-33', '1983-02-18', 'Ana Carolina Costa', 'Brasileira'),
('567.890.123-44', '1990-03-03', 'Luiz Henrique', 'Brasileira'),
('678.901.234-55', '1991-04-16', 'Juliana Souza', 'Brasileira'),
('789.012.345-66', '1984-05-29', 'Luciano Silva', 'Brasileira'),
('890.123.456-77', '1993-06-12', 'Fernando Santos', 'Brasileira'),
('901.234.567-88', '1986-07-25', 'Maria Clara', 'Brasileira'),
('012.345.678-99', '1992-08-08', 'Henrique Almeida', 'Brasileira'),
('123.456.789-00', '2008-02-14', 'Mateus Ferreira', 'Brasileira'),
('234.567.890-11', '2001-01-01', 'Alice Costa', 'Portuguesa'),
('345.678.901-22', '2003-06-05', 'Rafaela Oliveira', 'Espanhola'),
('456.789.012-33', '2002-12-25', 'Eduardo Martins', 'Mexicana'),
('567.890.123-44', '2006-07-16', 'Natália Silva', 'Italiana'),
('678.901.234-55', '2004-09-11', 'Leonardo Souza', 'Alemã'),
('789.012.345-66', '2002-11-03', 'Marcela Santos', 'Argentino'),
('890.123.456-77', '2005-05-22', 'Thiago Ribeiro', 'Canadense'),
('901.234.567-88', '2000-04-09', 'Mariana Rocha', 'Chilena'),
('012.345.678-99', '2001-10-30', 'Vinícius Alves', 'Uruguaia'),
('123.456.789-11', '2005-02-18', 'Isabela Costa', 'Brasileira'),
('234.567.890-22', '2003-06-12', 'Lucas Oliveira Bianchi', 'Italiana'),
('345.678.901-33', '2004-08-08', 'Ana Beatriz Santos', 'Portuguesa'),
('456.789.012-44', '2006-09-25', 'Giovanni Costa', 'Mexicana'),
('567.890.123-55', '2001-11-11', 'Juliana Oliveira', 'Espanhola'),
('678.901.234-66', '2003-12-24', 'Márcio Souza', 'Canadense'),
('789.012.345-77', '2000-03-03', 'Leandro Silva', 'Argentino'),
('890.123.456-88', '2002-05-29', 'Thaís Santos', 'Alemã'),
('901.234.567-99', '2004-08-31', 'Bruno Castro', 'Chilena'),
('012.345.678-00', '2005-10-10', 'Gabriela Almeida', 'Uruguaia');




INSERT INTO `EscoladeMusicaSilasCando`.`Instrumento` (`Nome`) VALUES
('Violino'),
('Viola'),
('Violoncelo'),
('Contrabaixo'),
('Flauta'),
('Oboé'),
('Clarinete'),
('Fagote'),
('Trompa'),
('Trompete'),
('Trombone'),
('Tuba'),
('Harpa'),
('Piano'),
('Timpani'),
('Xilofone'),
('Vibrafone'),
('Marimba'),
('Glockenspiel'),
('Celesta'),
('Saxofone'),
('Trompa de Eufônio'),
('Corneta'),
('Clarone'),
('Sino'),
('Címbalo'),
('Reco-reco'),
('Tamborim'),
('Pandeiro'),
('Agogô');



INSERT INTO `EscoladeMusicaSilasCando`.`Sinfonia` (`Nome`, `Compositor`, `Dt_criacao`) VALUES
('Sinfonia n.º 1', 'Beethoven', '1800-01-01'),
('Sinfonia n.º 2', 'Beethoven', '1802-01-01'),
('Sinfonia n.º 3', 'Beethoven', '1804-01-01'),
('Sinfonia n.º 4', 'Beethoven', '1806-01-01'),
('Sinfonia n.º 5', 'Beethoven', '1808-01-01'),
('Sinfonia n.º 6', 'Beethoven', '1808-01-01'),
('Sinfonia n.º 7', 'Beethoven', '1813-01-01'),
('Sinfonia n.º 8', 'Beethoven', '1814-01-01'),
('Sinfonia n.º 9', 'Beethoven', '1824-01-01'),
('Sinfonia n.º 1', 'Brahms', '1876-01-01'),
('Sinfonia n.º 2', 'Brahms', '1877-01-01'),
('Sinfonia n.º 3', 'Brahms', '1883-01-01'),
('Sinfonia n.º 4', 'Brahms', '1885-01-01'),
('Sinfonia n.º 1', 'Tchaikovsky', '1866-01-01'),
('Sinfonia n.º 2', 'Tchaikovsky', '1873-01-01'),
('Sinfonia n.º 3', 'Tchaikovsky', '1875-01-01'),
('Sinfonia n.º 4', 'Tchaikovsky', '1878-01-01'),
('Sinfonia n.º 5', 'Tchaikovsky', '1888-01-01'),
('Sinfonia n.º 6', 'Tchaikovsky', '1893-01-01'),
('Sinfonia n.º 1', 'Mahler', '1888-01-01'),
('Sinfonia n.º 2', 'Mahler', '1895-01-01'),
('Sinfonia n.º 3', 'Mahler', '1896-01-01'),
('Sinfonia n.º 4', 'Mahler', '1901-01-01'),
('Sinfonia n.º 5', 'Mahler', '1904-01-01'),
('Sinfonia n.º 6', 'Mahler', '1906-01-01'),
('Sinfonia n.º 7', 'Mahler', '1908-01-01'),
('Sinfonia n.º 8', 'Mahler', '1910-01-01'),
('Sinfonia n.º 9', 'Mahler', '1910-01-01'),
('Sinfonia n.º 1', 'Shostakovich', '1926-01-01'),
('Sinfonia n.º 2', 'Shostakovich', '1927-01-01'),
('Sinfonia nº 1', 'Mozart', '1764-01-01'),
('Sinfonia nº 2', 'Mozart', '1770-01-01'),
('Sinfonia nº 3', 'Mozart', '1774-01-01'),
('Sinfonia nº 4', 'Mozart', '1775-01-01'),
('Sinfonia nº 5', 'Mozart', '1775-01-01'),
('Sinfonia nº 6', 'Mozart', '1775-01-01'),
('Sinfonia nº 7', 'Mozart', '1778-01-01'),
('Sinfonia nº 8', 'Mozart', '1779-01-01'),
('Sinfonia nº 9', 'Mozart', '1779-01-01'),
('Sinfonia nº 10', 'Mozart', '1783-01-01'),
('Sinfonia nº 11', 'Mozart', '1783-01-01'),
('Sinfonia nº 12', 'Mozart', '1784-01-01'),
('Sinfonia nº 13', 'Mozart', '1785-01-01'),
('Sinfonia nº 14', 'Mozart', '1785-01-01'),
('Sinfonia nº 15', 'Mozart', '1786-01-01'),
('Sinfonia nº 16', 'Mozart', '1786-01-01'),
('Sinfonia nº 17', 'Mozart', '1787-01-01'),
('Sinfonia nº 18', 'Mozart', '1787-01-01'),
('Sinfonia nº 19', 'Mozart', '1788-01-01'),
('Sinfonia nº 20', 'Mozart', '1788-01-01'),
('Sinfonia nº 21', 'Mozart', '1788-01-01');



INSERT INTO `EscoladeMusicaSilasCando`.`Funcao` 
(`IdFruncao`, `Nome`, `Musico_idMusico`)
VALUES 
(1, 'Violino I', 1),
(2, 'Violino II', 2),
(3, 'Viola', 3),
(4, 'Violoncelo', 4),
(5, 'Contrabaixo', 5),
(6, 'Violino I', 6),
(7, 'Violino II', 7),
(8, 'Viola', 8),
(9, 'Violoncelo', 9),
(10, 'Contrabaixo', 10),
(11, 'Violino I', 11),
(12, 'Violino II', 12),
(13, 'Viola', 13),
(14, 'Violoncelo', 14),
(15, 'Contrabaixo', 15),
(16, 'Violino I', 16),
(17, 'Violino II', 17),
(18, 'Viola', 18),
(19, 'Violoncelo', 19),
(20, 'Contrabaixo', 20),
(21, 'Violino I', 21),
(22, 'Violino II', 22),
(23, 'Viola', 23),
(24, 'Violoncelo', 24),
(25, 'Contrabaixo', 25),
(26, 'Violino I', 26),
(27, 'Violino II', 27),
(28, 'Viola', 28),
(29, 'Violoncelo', 29),
(30, 'Contrabaixo', 30),
(31, 'Violino I', 31),
(32, 'Violino II', 32),
(33, 'Viola', 33),
(34, 'Violoncelo', 34),
(35, 'Contrabaixo', 35),
(36, 'Violino I', 36),
(37, 'Violino II', 37),
(38, 'Viola', 38),
(39, 'Violoncelo', 39),
(40, 'Contrabaixo', 40),
(51, 'Clarinetista', 40), 
(41, 'Maestro', 1), 
(42, 'Violinista', 2), 
(43, 'Violoncelista', 3), 
(44, 'Baixista', 4), 
(45, 'Flautista', 5), 
(46, 'Pianista', 6), 
(47, 'Maestro', 7), 
(48, 'Trompetista', 8), 
(49, 'Oboista', 9), 
(50, 'Clarinetista', 10);

INSERT INTO `EscoladeMusicaSilasCando`.`Funcao` 
(`IdFruncao`, `Nome`, `Musico_idMusico`)
VALUES 
(65, 'Regente', 1),
(52, 'Solista', 2),
(53, 'Viola II', 3),
(54, 'Solista', 4),
(55, 'Solista', 5),
(56, 'Maestro', 6),
(57, 'Maestro', 7),
(58, 'Viola II', 8),
(59, 'Maestro', 9),
(60, 'Regente', 10),
(61, 'Solista', 11);

INSERT INTO `EscoladeMusicaSilasCando`.`Funcao` 
(`IdFuncao`, `Nome`, `Musico_idMusico`)
VALUES 
(75, 'Regente', 10),
(82, 'Solista', 20),
(83, 'Viola II', 33),
(84, 'Solista', 40),
(85, 'Solista', 15),
(86, 'Maestro', 16),
(87, 'Maestro', 37),
(88, 'Viola II', 38),
(89, 'Maestro', 29),
(90, 'Regente', 30),
(91, 'Solista', 31);



INSERT INTO EscoladeMusicaSilasCando.Apresenta (Musico_idMusico, Sinfonia_idSinfonia, Funcao_IdFruncao, Dt_apresentacao)
VALUES
(1, 2, 3, '2022-05-01'),
(2, 5, 7, '2021-08-15'),
(3, 10, 15, '2019-11-20'),
(4, 12, 19, '2020-06-03'),
(5, 20, 26, '2022-01-10'),
(6, 25, 31, '2018-12-08'),
(7, 30, 36, '2023-02-21'),
(8, 41, 46, '2023-03-17'),
(9, 49, 51, '2021-09-27'),
(10, 50, 2, '2018-07-05'),
(11, 1, 9, '2022-11-23'),
(12, 8, 14, '2020-04-19'),
(13, 11, 20, '2019-06-11'),
(14, 16, 28, '2021-05-29'),
(15, 21, 33, '2022-08-02'),
(16, 26, 38, '2018-09-18'),
(17, 32, 44, '2023-01-06'),
(18, 39, 50, '2020-11-12'),
(19, 42, 4, '2021-04-25'),
(20, 45, 11, '2018-10-09'),
(21, 48, 18, '2019-12-30'),
(22, 2, 25, '2022-06-14'),
(23, 7, 30, '2022-03-06'),
(24, 13, 35, '2023-04-02'),
(25, 17, 41, '2020-02-28'),
(26, 22, 47, '2019-08-12'),
(27, 27, 49, '2022-12-19'),
(28, 33, 5, '2022-02-11'),
(29, 40, 12, '2021-01-08'),
(30, 43, 17, '2020-07-16');

INSERT INTO EscoladeMusicaSilasCando.Apresenta (Musico_idMusico, Sinfonia_idSinfonia, Funcao_IdFruncao, Dt_apresentacao)
VALUES
(31, 20, 50, '2022-05-01'),
(32, 15, 27, '2021-08-15'),
(33, 1, 30, '2019-11-20'),
(34, 2, 19, '2020-06-03'),
(35, 12, 16, '2022-01-10'),
(36, 2, 41, '2018-12-08'),
(37, 50, 36, '2023-02-21'),
(38, 21, 36, '2023-03-17'),
(39, 29, 11, '2021-09-27'),
(40, 10, 22, '2018-07-05');


INSERT INTO EscoladeMusicaSilasCando.Apresenta (Musico_idMusico, Sinfonia_idSinfonia, Funcao_IdFruncao, Dt_apresentacao)
VALUES
(6, 5, 11, '2018-12-08'),
(7, 33, 6, '2023-02-21'),
(8, 44, 26, '2023-03-17'),
(9, 4, 31, '2021-09-27'),
(10, 15, 22, '2018-07-05'),
(11, 19, 90, '2022-11-23'),
(12, 28, 34, '2020-04-19'),
(13, 21, 23, '2019-06-11'),
(14, 36, 8, '2021-05-29'),
(15, 21, 13, '2022-08-02'),
(16, 6, 48, '2018-09-18'),
(17, 42, 14, '2023-01-06'),
(18, 49, 30, '2020-11-12'),
(19, 22, 84, '2021-04-25'),
(20, 25, 90, '2018-10-09'),
(21, 18, 28, '2019-12-30');



INSERT INTO `EscoladeMusicaSilasCando`.`Pertence` (`Musico_idMusico`, `Orquestra_idOrquestra`)
VALUES 
(1, 5),
(2, 10),
(3, 4),
(4, 19),
(5, 6),
(6, 1),
(7, 12),
(8, 17),
(9, 9),
(10, 20),
(11, 8),
(12, 2),
(13, 14),
(14, 16),
(15, 3),
(16, 11),
(17, 7),
(18, 13),
(19, 18),
(20, 15),
(21, 1),
(22, 3),
(23, 2),
(24, 4),
(25, 6),
(26, 5),
(27, 8),
(28, 10),
(29, 7),
(30, 9),
(31, 1),
(32, 3),
(33, 2),
(34, 4),
(35, 6),
(36, 5),
(37, 8),
(38, 10),
(39, 7),
(40, 9);


INSERT INTO `EscoladeMusicaSilasCando`.`Toca` (`Musico_idMusico`, `Instrumento_IdInstrumento`)
VALUES
(1,30),
(2,29),
(3,28),
(4,27),
(5,26),
(6,25),
(7,24),
(8,23),
(9,22),
(10,21),
(11,20),
(12,19),
(13,18),
(14,17),
(15,16),
(16,15),
(17,14),
(18,13),
(19,12),
(20,11),
(21,10),
(22,9),
(23,8),
(24,7),
(25,6),
(26,5),
(27,4),
(28,3),
(29,2),
(30,1),
(31,20),
(32,18),
(33,5),
(34,15),
(35,22),
(36,4),
(37,2),
(38,1),
(39,6),
(40,12);



INSERT INTO executa
VALUES 
(1,51),
(2,50),
(3,49),
(4,48),
(5,47),
(6,46),
(7,45),
(8,44),
(9,43),
(10,42),
(11,41),
(12,40),
(13,39),
(14,38),
(15,37),
(16,36),
(17,35),
(18,34),
(19,33),
(20,32),
(21,31),
(1,30),
(2,29),
(3,28),
(4,27),
(5,26),
(6,25),
(7,24),
(8,23),
(9,22),
(10,21),
(11,20),
(12,19),
(13,18),
(14,17),
(15,16),
(16,15),
(17,14),
(18,13),
(19,12),
(20,11),
(21,10),
(1,9),
(2,8),
(3,7),
(4,6),
(5,5),
(4,4),
(3,3),
(2,2),
(1,1);



-- UPDATES E DELETES

update orquestra
set nome = "Orquestra do Brasil"
where idorquestra = 2;


update orquestra
set pais = "EUA"
where idorquestra = 16;

delete from orquestra where idorquestra = 21;

update musico
set nacionalidade = "Norueguesa"
where idmusico = 40;

update musico
set nacionalidade = "Japonesa"
where idmusico = 10;


update musico
set nacionalidade = "Australiana"
where idmusico = 3;


update sinfonia
set nome = "sinfonia bonita"
where idsinfonia = 30;

update sinfonia
set nome = "sinfonia bela"
where idsinfonia = 19;

update sinfonia
set Dt_criacao = '1802-01-02'
where idsinfonia = 2;

update sinfonia
set nome = "nome alterado"
where idsinfonia = 22;


update funcao
set nome = "Maestro"
where idFuncao = 90;

update funcao
set musico_idmusico = 40
where idFuncao = 75;

update funcao
set nome = "Harpa"
where idFuncao = 86;

update apresenta
set Dt_apresentacao = '2023-03-12'
where Musico_idMusico = 30;

update apresenta
set Funcao_IdFruncao = 33
where Musico_idMusico = 25;

update apresenta
set Dt_apresentacao = '2022-12-12'
where Musico_idMusico = 10;

update toca 
set instrumento_idinstrumento = 2
where musico_idmusico = 40;


update toca 
set instrumento_idinstrumento = 9
where musico_idmusico = 22;



update toca 
set instrumento_idinstrumento = 15
where musico_idmusico = 10;

update executa
set orquestra_idorquestra = 20
where orquestra_idorquestra = 21;


-- VIEWS


create view contagem_Musicos as        
SELECT orq.nome "Oquestra", count(mus.idmusico) "Musicos Cadastrados"
	from pertence pert 
	right join orquestra orq on pert.Orquestra_idOrquestra = orq.idOrquestra
    left join musico mus on pert.Musico_idMusico = mus.idMusico
		group by orq.idOrquestra;
        
        
        
create view contagem_funcao as
select mus.Nome , mus.identidade , count(func.IdFuncao) 
	from musico mus
	left join funcao func on mus.idMusico = func.Musico_idMusico
		group by mus.idMusico
        order by  count(func.IdFuncao) desc;
        
create view idade_musico as  
SELECT nome, idMusico, TIMESTAMPDIFF(YEAR, Dt_nascimento, NOW()) AS idade FROM musico;


create view contagem_sinfoniaa as
SELECT mus.nome "musico" , mus.identidade, mus.nacionalidade, sinf.nome, count( apre.Dt_apresentacao ) 
from apresenta apre 
inner join musico mus on mus.idMusico = apre.Musico_idMusico
inner join sinfonia sinf on apre.Sinfonia_idSinfonia = sinf.idSinfonia
	group by mus.idMusico
    order by count( (select apre.Dt_apresentacao >= '2022-01-01' )) desc, mus.Nome;
    
    create view apresentacoes_2022 as
    select count(Dt_apresentacao) from apresenta where Dt_apresentacao like '2022%';
    
    
    
    create view musicos_menos21anos as
select mus.nome, mus.identidade, idade.idade  
from musico mus
inner join idade_musico idade on idade.idMusico = mus.idMusico
where  idade.idade < 21;

create view tocam_beethoven as
select mus.nome"Musico", sinf.nome,sinf.Compositor, func.nome"Funcao", apr.Dt_apresentacao
from apresenta apr 
inner join musico mus on apr.Musico_idMusico = mus.idMusico
inner join sinfonia sinf on apr.Sinfonia_idSinfonia = sinf.idSinfonia
inner join funcao func on apr.Funcao_IdFruncao = func.idfuncao
where sinf.Compositor like 'beethoven'
order by apr.Dt_apresentacao desc;
    
    
 create view instupmentosPorMusico as
 select inst.nome, count(toc.Musico_idMusico)
from toca toc 
right join instrumento inst on toc.Instrumento_IdInstrumento = inst.IdInstrumento
left join musico mus on toc.Musico_idMusico = mus.idMusico
group by inst.IdInstrumento
order by count(toc.Musico_idMusico) desc; 

create view tocadas_por_brasileiros_em2023 as
select sinf.nome "Sinfonia", mus.nome "Musico", case when mus.nacionalidade like 'Brasileira' then "SIM" else "NÃO" end "É Brasileiro?"
from apresenta apre 
inner join musico mus on apre.Musico_idMusico = mus.idMusico
inner join sinfonia sinf on apre.Sinfonia_idSinfonia = sinf.idSinfonia
where apre.Dt_apresentacao >= '2023-01-01';
    
create view maestros_menos_de_30A as
select sinf.nome "Sinfonia", mus.nome "Musico", idade.idade "Idade do Musico", func.nome "Função" 
from apresenta apre 
inner join sinfonia sinf on apre.Sinfonia_idSinfonia = sinf.idSinfonia
inner join musico mus on apre.Musico_idMusico = mus.idMusico
inner join funcao func on apre.Funcao_IdFruncao = func.idfuncao
inner join idade_musico idade on idade.idmusico = mus.idMusico
where idade.idade < 30 and func.Nome like 'maestro';    
    
    
    
    
    
    
    
    
    
    
    
    
    



